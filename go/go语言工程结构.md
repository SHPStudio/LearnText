# go语言工程结构
## 工作区
### src
  用于保存go的源码文件，代码包与src下的子目录一一对应。例如，如果一个源码文件被声明属于代码包log，那么它应该保存在src/log目录下。

### pkg目录
  用于存放通过go install命令安装后的代码包的归档文件。前提是代码包中必须含有go库源码文件。归档文件是以`.a`结尾的文件。与GOROOT目录下的pkg目录功能类似。区别就是，工作区的pkg目录专门来存放用户代码的归档文件。
编译和安装用户代码的过程一般会以代码包为单位进行。例如log包被编译安装后，将生成一个名为log.a的归档文件，并存放在当前工作去的pkg目录下的平台相关目录中。

### bin目录
与pkg目录类似，在通过go install命令完成安装后，保存由go命令源码文件生成的可执行文件。在类Unix操作系统下，这个可执行文件一般来说名称与源码文件的主文件名相同 **不带后缀名** 。而在Windows操作系统下，这个可执行文件的名称则是源码文件主文件加 **.exe后缀**。

**注意**
需要明确一下Go语言的命令源码文件和库源码文件的区别。前者是声明属于main代码包并且包含无参数声明和结果声明的main函数的源码文件。这类源码文件是程序的入口，可以独立运行(go run),也可以通过go build或者go install命令得到相应的可执行文件。后者是指存在于某个代码包中的普通源码文件。

## GOPATH
该路径是指工作区的目录，并且可以由多个。不过需要注意的是不要把Go语言的根目录包含进来，为的是能够更好的分开go语言本身的工作区和用户工作区。
通过Go工具的代码获取命令go get，可将指定项目的源码下载到GOPATH的第一个工作区中，并在其中完成编译和安装。

## 源码文件
### 命令源码文件
如果一个源码文件被声明属于**main代码包**，且该文件代码中包含**无参数和结果声明的main函数**，那么就是**命令源码文件**。
它可通过go run命令直接启动运行。
同一个代码包中的所有源码文件，所属包名称必须一致，如果命令源码文件和库源码文件处于同一个代码包中，那么该包无法正确执行go build和go install。
所以，命令源码文件通常会单独放在一个代码包中。这是合理并且必要的，因为通常一个程序模块或者软件的启动入口只有一个。
一个代码包中可以有多个命令源码文件，可以通过go run命令分别运行，但是会使go build和go install命令无法编译和安装。
当代码包中有且只有一个命令源码文件时，可在所在目录中执行go build命令，即可在目录下生成一个与目录同名的可执行文件；如果使用go install则可在当前工作去的bin目录下生成相应的可执行文件。

### 库源码文件
库源码文件声明的包名会与直接所属的代码包(目录)名字一致，并且没有main函数。
安装库源码文件时所生成的归档文件会被存放到当前工作区的pkg目录中。并且归档文件会根据编译时目标计算机环境放到不同的平台相关目录中。例如linux64位对应的目录就是linux_amd64,那么归档文件会存放到`工作区目录/pkg/linux_amd64/github.com/库源码包路径`,安装后的库源码文件后缀是`.a`

### 测试源码文件
它是一种特殊的库文件，可通过go test命令运行当前代码包下所有的测试源码文件。成为测试源码文件的条件有两个
- 文件名以`_test.go`结尾
- 文件中至少包含一个名称以Test开头或Benchmark开头，并且拥有一个类型位`*testing.T`或`*testing.B`的参数的函数。
testing.T和testing.B是两个结构体类型。而带*则表示为二者的指针类型。他们分别是功能测试和基准测试所需要的。

**注意** Go代码文本文件需要以UTF-8编码存储。如果是非UTF-8字符，运行、编译安装时会抛出illegal UTF-8 sequence错误。

## 代码包